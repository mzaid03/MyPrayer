<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Prayer Reminder</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(to bottom right, #e0f7fa, #e8f5e9);
      color: #1b5e20;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }
    .card {
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      max-width: 500px;
      width: 100%;
      text-align: center;
      animation: fadeIn 1s ease-in-out;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: #004d40;
    }
    ul {
      list-style: none;
      padding: 0;
      margin-bottom: 2rem;
    }
    li {
      margin: 0.5rem 0;
      font-size: 1.2rem;
      background: #f1f8e9;
      border-radius: 12px;
      padding: 0.75rem;
      transition: transform 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }
    li:hover {
      transform: scale(1.05);
      background: #dcedc8;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    blockquote {
      background: #ede7f6;
      padding: 1rem;
      border-left: 5px solid #673ab7;
      border-radius: 10px;
      font-style: italic;
    }
    button {
      margin-top: 1rem;
      background: #1b5e20;
      color: white;
      padding: 0.7rem 1.5rem;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: #33691e;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>ðŸŒŸ Iqamah Times Today</h1>
    <ul>
      <li>Fajr: <span id="fajr"></span></li>
      <li>Dhuhr: <span id="dhuhr"></span></li>
      <li>Asr: <span id="asr"></span></li>
      <li>Maghrib: <span id="maghrib"></span></li>
      <li>Isha: <span id="isha"></span></li>
    </ul>
    <p id="timezone" style="font-size: 0.95rem; color: #666; margin-top: 1rem;"></p>
    <h1>ðŸ“š A Verse to Heal Your Heart</h1>
    <blockquote id="quote"></blockquote>
    <button onclick="refreshQuote()">New Quote</button>
  </div>

  <script>
    const quotes = [
      "Indeed, prayer prohibits immorality and wrongdoing. (29:45)",
  "And establish prayer and give zakah. (2:43)",
  "Verily, in the remembrance of Allah do hearts find rest. (13:28)",
  "Establish prayer at the decline of the sun. (17:78)",
  "Successful indeed are the believers who are humble in their prayers. (23:1-2)",
  "Indeed, Allah is with those who fear Him and those who are doers of good. (16:128)",
  "And seek help through patience and prayer. (2:45)",
  "Indeed, Allah commands justice and the doing of good. (16:90)",
  "He created the heavens and earth in truth. (39:5)",
  "So remember Me; I will remember you. (2:152)",
  "And whoever relies upon Allah â€“ then He is sufficient for him. (65:3)",
  "Say, 'Nothing will happen to us except what Allah has decreed for us.' (9:51)",
  "So verily, with the hardship, there is relief. (94:6)",
  "Your Lord has not forsaken you, nor has He detested [you]. (93:3)",
  "And We have certainly created man and We know what his soul whispers to him. (50:16)",
  "And We have not sent you, [O Muhammad], except as a mercy to the worlds. (21:107)",
  "Indeed, Allah loves those who rely upon Him. (3:159)",
  "Indeed, with hardship [will be] ease. (94:5)",
  "Allah is the ally of those who believe. (2:257)",
  "Say: My Lord has commanded justice. (7:29)",
  "And be patient, for indeed, Allah does not allow to be lost the reward of those who do good. (11:115)",
  "He knows what is [presently] before them and what will be after them. (20:110)",
  "Indeed, the mercy of Allah is near to the doers of good. (7:56)",
  "And whoever does righteous deeds, whether male or female, while being a believer â€“ those will enter Paradise. (4:124)",
  "Indeed, prayer has been decreed upon the believers a decree of specified times. (4:103)",
  "Indeed, your Lord is vast in forgiveness. (53:32)",
  "Say, 'In the bounty of Allah and in His mercy â€“ in that let them rejoice.' (10:58)",
  "And among His signs is that He created for you from yourselves mates that you may find tranquility in them. (30:21)",
"They are clothing for you and you are clothing for them. (2:187)",
"And We created you in pairs. (78:8)",
"Your spouses are a garment for you. (2:187)",
"And He placed between you affection and mercy. (30:21)",
"And live with them in kindness. (4:19)",
"It is He who created you from one soul and created from it its mate. (7:189)",
"And Allah has made for you from your homes a place of rest. (16:80)",
"And of everything We created two mates. (51:49)",
"So do not weaken and do not grieve. (3:139)",
"And We have certainly honored the children of Adam. (17:70)",
"Indeed, the most noble of you in the sight of Allah is the most righteous of you. (49:13)",
"And cooperate in righteousness and piety. (5:2)",
"Indeed, Allah loves those who act justly. (5:42)",
"Do not forget graciousness between you. (2:237)",
"Speak to people good [words]. (2:83)",
"And give the women [upon marriage] their [bridal] gifts graciously. (4:4)",
"And consult with them in matters. (3:159)",
"Indeed, the best of you are those who are best to their wives. (Hadith)",
"And you will find the nearest of them in affection to the believers those who say, 'We are Christians.' (5:82)",
"And those who say, 'Our Lord, grant us from among our wives and offspring comfort to our eyes.' (25:74)",
"And lower to them the wing of humility out of mercy. (17:24)",
"Worship Allah and associate nothing with Him, and to parents do good. (4:36)",
"But if they endeavor to make you associate with Me that of which you have no knowledge, do not obey them but accompany them in [this] world with appropriate kindness. (31:15)",
"And be patient over what they say and avoid them with gracious avoidance. (73:10)",
"Indeed, the mercy of Allah is near to the doers of good. (7:56)"
    ];

function refreshQuote() {
    const quote = quotes[Math.floor(Math.random() * quotes.length)];
    document.getElementById("quote").innerText = quote;
  }

  refreshQuote();

  const dhikr = ["SubhanAllah", "Alhamdulillah", "Allahu Akbar", "La ilaha illa Allah", "Astaghfirullah"];
  let currentDhikr = 0;
  setInterval(() => {
    document.title = "ðŸ•Š " + dhikr[currentDhikr];
    currentDhikr = (currentDhikr + 1) % dhikr.length;
  }, 5000); // Changes every 5 seconds

  function to12Hour(time24) {
    const [hourStr, minute] = time24.split(":");
    let hour = parseInt(hourStr);
    const ampm = hour >= 12 ? 'PM' : 'AM';
    hour = hour % 12 || 12;
    return `${hour}:${minute} ${ampm}`;
  }

  function getNextPrayer(prayerTimes) {
    const now = new Date();
    for (let [name, time] of Object.entries(prayerTimes)) {
      const [h, m] = time.split(":");
      const prayerDate = new Date(now);
      prayerDate.setHours(parseInt(h), parseInt(m), 0);
      if (prayerDate > now) return { name, time: prayerDate };
    }
    return null;
  }

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(position => {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;

      fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=2`)
        .then(response => response.json())
        .then(data => {
          const timings = data.data.timings;
          const hijri = data.data.date.hijri;

          document.getElementById("fajr").innerText = to12Hour(timings.Fajr);
          document.getElementById("dhuhr").innerText = to12Hour(timings.Dhuhr);
          document.getElementById("asr").innerText = to12Hour(timings.Asr);
          document.getElementById("maghrib").innerText = to12Hour(timings.Maghrib);
          document.getElementById("isha").innerText = to12Hour(timings.Isha);
          document.getElementById("timezone").innerText = `ðŸ•“ Timezone: ${data.data.meta.timezone}`;
          
          // Hijri date display
          const hijriDate = `${hijri.day} ${hijri.month.en} ${hijri.year} AH`;
          const hijriElement = document.createElement("p");
          hijriElement.textContent = `ðŸ“… Islamic Date: ${hijriDate}`;
          hijriElement.style.marginTop = "1rem";
          hijriElement.style.fontSize = "0.95rem";
          document.querySelector(".card").appendChild(hijriElement);

          // Next prayer countdown
          const prayerMap = {
            Fajr: timings.Fajr,
            Dhuhr: timings.Dhuhr,
            Asr: timings.Asr,
            Maghrib: timings.Maghrib,
            Isha: timings.Isha
          };
          const next = getNextPrayer(prayerMap);
          if (next) {
            const countdownEl = document.createElement("p");
            countdownEl.style.marginTop = "1rem";
            countdownEl.style.fontSize = "0.95rem";
            countdownEl.style.color = "#fff";
            document.querySelector(".card").appendChild(countdownEl);

            setInterval(() => {
              const now = new Date();
              const diff = Math.max(0, Math.floor((next.time - now) / 1000));
              const hrs = Math.floor(diff / 3600);
              const mins = Math.floor((diff % 3600) / 60);
              const secs = diff % 60;
              countdownEl.textContent = `ðŸ•° Next Prayer (${next.name}) in ${hrs}h ${mins}m ${secs}s`;
            }, 1000);
          }
        })
        .catch(err => {
          console.error("Failed to fetch prayer times:", err);
          document.getElementById("timezone").innerText = "Could not load prayer times. Please refresh and allow location.";
        });
    });
  } else {
    alert("Please allow location access to get accurate prayer times.");
  }
</script>
